
<div class="form-container">
  
  <h2>{{ editTask ? 'Edit Task' : 'Create New Task' }}</h2>

  <!-- 
    [formGroup] - binds to our FormGroup
    (ngSubmit) - handles form submission
  -->
  <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="task-form">

    <!-- TITLE FIELD -->
    <div class="form-group">
      <label for="title">
        Title <span class="required">*</span>
      </label>
      
      <!-- formControlName binds to form control -->
      <input 
        type="text" 
        id="title"
        formControlName="title"
        placeholder="Enter task title"
        class="form-control"
        [class.invalid]="title?.invalid && title?.touched"
      >
      
      <!-- Validation Error Messages -->
      <div class="error-message" *ngIf="title?.invalid && title?.touched">
        <small *ngIf="title?.errors?.['required']">
          Title is required
        </small>
        <small *ngIf="title?.errors?.['minlength']">
          Title must be at least 3 characters
        </small>
      </div>
    </div>

    <!-- DESCRIPTION FIELD -->
    <div class="form-group">
      <label for="description">
        Description <span class="required">*</span>
      </label>
      
      <textarea 
        id="description"
        formControlName="description"
        placeholder="Enter task description"
        rows="4"
        class="form-control"
        [class.invalid]="description?.invalid && description?.touched"
      ></textarea>
      
      <!-- Validation Errors -->
      <div class="error-message" *ngIf="description?.invalid && description?.touched">
        <small *ngIf="description?.errors?.['required']">
          Description is required
        </small>
        <small *ngIf="description?.errors?.['minlength']">
          Description must be at least 10 characters
        </small>
      </div>
    </div>

    <!-- PRIORITY FIELD (SELECT/DROPDOWN) -->
    <div class="form-group">
      <label for="priority">
        Priority <span class="required">*</span>
      </label>
      
      <select 
        id="priority"
        formControlName="priority"
        class="form-control"
      >
        <!-- Loop through priority options -->
        <option *ngFor="let p of priorities" [value]="p">
          {{ p | titlecase }}
        </option>
      </select>
    </div>

    <!-- DUE DATE FIELD -->
    <div class="form-group">
      <label for="dueDate">
        Due Date <span class="required">*</span>
      </label>
      
      <input 
        type="date"
        id="dueDate"
        formControlName="dueDate"
        class="form-control"
        [class.invalid]="dueDate?.invalid && dueDate?.touched"
      >
      
      <!-- Validation Error -->
      <div class="error-message" *ngIf="dueDate?.invalid && dueDate?.touched">
        <small *ngIf="dueDate?.errors?.['required']">
          Due date is required
        </small>
      </div>
    </div>

    <!-- COMPLETED CHECKBOX (only when editing) -->
    <div class="form-group" *ngIf="editTask">
      <label class="checkbox-label">
        <input 
          type="checkbox"
          formControlName="completed"
        >
        <span>Mark as completed</span>
      </label>
    </div>

    <!-- FORM ACTIONS -->
    <div class="form-actions">
      <button 
        type="submit" 
        class="btn btn-primary"
        [disabled]="isSubmitting"
      >
        {{ isSubmitting ? 'Saving...' : (editTask ? 'Update Task' : 'Create Task') }}
      </button>

      <button 
        type="button" 
        class="btn btn-secondary"
        (click)="onCancel()"
        [disabled]="isSubmitting"
      >
        Cancel
      </button>
    </div>

    <!-- Form Status (for learning/debugging) -->
    <div class="form-debug" *ngIf="false">
      <p><strong>Form Status:</strong></p>
      <ul>
        <li>Valid: {{ taskForm.valid }}</li>
        <li>Touched: {{ taskForm.touched }}</li>
        <li>Dirty: {{ taskForm.dirty }}</li>
      </ul>
    </div>

  </form>
</div>